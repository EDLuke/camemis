<?///////////////////////////////////////////////////////////// @Thou Morng Sothearung// Date: 17.11.2010// 03 Rue des Pibleus Bailly Romainvilliers///////////////////////////////////////////////////////////require_once 'clients/CamemisPage.php';require_once 'clients/CamemisWindow.php';require_once 'clients/CamemisField.php';require_once 'clients/CamemisBar.php';require_once 'clients/CamemisGrid.php';require_once 'clients/CamemisForm.php';require_once 'clients/CamemisTree.php';require_once 'include/Common.inc.php';require_once 'utiles/Utiles.php';require_once setUserLoacalization();$CAMEMIS_PAGE_OBJECT = CamemisPage::getInstance();print $CAMEMIS_PAGE_OBJECT->showCamemisHeader();$term = isset($_GET["term"]) ? $_GET["term"] : '';?><script>Ext.chart.Chart.CHART_URL = '../public/<?=Zend_Registry::get('EXTJS_VERSION')?>/resources/charts.swf';var academicId = '<?=$this->academicId;?>';var subjectId = '<?=$this->subjectId;?>';var teacherId = '<?=$this->teacherId;?>';var term = '<?=$term;?>';Ext.onReady(function() {    Ext.QuickTips.init();    var fp = new Ext.FormPanel({        fileUpload: true        ,labelAlign: 'top'        ,border: false        ,autoHeight: true        ,title: ''        ,bodyStyle: 'padding: 15px;'        ,labelWidth: 150        ,defaults: {            anchor: '95%'            ,allowBlank: false            ,msgTarget: 'side'        }        ,items:[{            xtype: 'fileuploadfield'            ,id: 'form-file'            ,emptyText: '<?=SELECT_AN_XLS_FILE?>'            ,fieldLabel: '<?=FILE?>'            ,name: 'xlsfile'            ,buttonText: ''            ,buttonCfg: {                iconCls: 'upload-icon'            }        }]        ,tbar: [{            text: '<?=RESET;?>'            ,iconCls:'icon-arrow_undo'            ,handler: function(){                fp.getForm().reset();            }        },{            text: '<?=UPLOAD?>'            ,iconCls:'icon-disk'            ,disabled: false            ,handler: function(){                if(fp.getForm().isValid()){                                        Ext.Msg.progress('Import...', 'waiting...', 'progressing');                    var count = 0;                    var interval = window.setInterval(function() {                        count = count + 0.04;                        Ext.Msg.updateProgress(count);                        if(count >= 1) {                            window.clearInterval(interval);                            Ext.Msg.hide();                        }                    }, 100);                    Ext.Ajax.request({                        url: URL_JSONIMPORT_ASSIGNMENT                        ,isUpload: true                        ,headers: {'Content-type':'multipart/form-data'}                        ,method: 'POST'                        ,params:{                            subjectId: subjectId                            ,teacherId: teacherId                            ,academicId: academicId                            ,term: term                        }                        ,form: fp.getForm().getEl().dom                        ,waitMsg: 'Uploading your file...'                        ,success: function(response, options) {                            Ext.MessageBox.hide();                            Ext.MessageBox.show({                                title: '<?=STATUS;?>'                                ,msg: '<?=IMPORT_WAS_SUCCESSFUL;?>'                                ,buttons: Ext.MessageBox.OK                                ,fn: function(btn){                                     if (btn == 'ok'){                                         if(window.parent.Ext.getCmp('ASSESSMENT_LIST_ID'))                                            window.parent.Ext.getCmp('ASSESSMENT_LIST_ID').store.reload();                                         //window.parent.Ext.getCmp('OPEN_WIN_IFRAME_ID').close();                                     }                                }                            });                        }                    });            	}            }        }]    });    viewport = new Ext.Viewport({        layout: 'fit'        ,border: false        ,items:[{            layout:'fit'            ,border: false            ,items:[{                border: false                ,layout:'form'                ,items: fp            }]        }]    }); });</script><?$registry = Zend_Registry::getInstance();print $CAMEMIS_PAGE_OBJECT->showCamemisFooter();?>